import re

class httpFilterExploitation:
    def __init__(self):
        self.results = []
        
    #------------------------------------------------------------------------------------
    
    # filter hydra output
    def parse_hydra_output(self, output):
        """
        Parses the output of the Hydra tool to extract the cracked password.
        """
        pattern = r"\[\d+\]\[http-post-form\] host: ([^\s]+)\s+login: ([^\s]+)\s+password: ([^\s]+)"
        match = re.search(pattern, output)
        
        if match:
            return {
                "Host": match.group(1),
                "Login": match.group(2),
                "Password": match.group(3)
                }
        else:
            return None
        
    #------------------------------------------------------------------------------------
    
    def parse_sqlmap_db_scan_output(self, output):
        """
        Parses the output of the SQLMap tool to extract the database scan results.
        """
        databases_section = re.search(r"available databases \[\d+\]:\n(\[\*\] .+\n)+", output)
        
        if databases_section:
            # If the databases section is found, extract only the database names
            pattern = r"\[\*\] (.+)"
            return re.findall(pattern, databases_section.group(0))
        else:
            return []
        
    #------------------------------------------------------------------------------------
    
    def parse_sqlmap_table_dump_output(self, output):
        """
        Parses the output of the SQLMap tool to extract the table dump results.
        """
        tables = re.findall(r'\|\s+(\w+)\s+\|', output)
        
        if tables:
            return tables
        
        
        